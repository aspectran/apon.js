<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APON.js Interactive Demo</title>
    <link rel="stylesheet" type="text/css" href="https://assets.aspectran.com/bootstrap@5.3.8/css/aspectran.css?v=20251017"/>
    <script src="lib/apon.js"></script>
    <style>
        /* Ensure textareas fill the card body */
        .card-body .form-control {
            flex-grow: 1;
            resize: none; /* Disable manual resize for a cleaner look */
        }
        /* Adjust textarea height and prevent text wrapping */
        .card-body textarea.form-control {
            min-height: 450px;
            white-space: pre;
            overflow-x: auto;
        }
    </style>
</head>
<body>

<main class="container mt-4">
    <div class="text-center mb-4">
        <h1>APON.js Interactive Demo</h1>
        <p class="lead">This tool allows you to interactively convert between APON and JavaScript Objects.</p>
    </div>

    <div class="row g-4">
        <!-- APON Input Column -->
        <div class="col-md-6">
            <div class="card h-100">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">APON Input</h5>
                    <p class="card-text text-muted small">&raquo; Edit the APON text and click <strong>Parse to JS Object</strong>.</p>
                    <div class="mb-3 flex-grow-1 d-flex">
                        <textarea id="apon-input" class="form-control font-monospace"># Edit this APON text
server: {
  name: MyServer
  port(int): 8080
  features: [
    HTTP2
    SSL
    "Web Sockets"
  ]
}
description(text): (
  |This is a multi-line text block.
  |Feel free to edit and test.
)
</textarea>
                    </div>
                    <button class="btn btn-primary" onclick="runParse()">Parse to JS Object &raquo;</button>
                    <div id="parse-error" class="alert alert-danger mt-3" role="alert" style="display: none;"></div>
                </div>
            </div>
        </div>

        <!-- JSON Output Column -->
        <div class="col-md-6">
            <div class="card h-100">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">JS Object / JSON Output</h5>
                    <p class="card-text text-muted small">&raquo; Edit the JSON and click <strong>Stringify to APON</strong>.</p>
                    <div class="mb-3 flex-grow-1 d-flex">
                        <textarea id="json-output" class="form-control font-monospace">{
  "hello": "world",
  "version": 1,
  "settings": {
    "enabled": true,
    "modes": [
      "admin",
      "user"
    ]
  }
}</textarea>
                    </div>
                    <button class="btn btn-secondary" onclick="runStringify()">&laquo; Stringify to APON</button>
                    <div id="stringify-error" class="alert alert-danger mt-3" role="alert" style="display: none;"></div>
                </div>
            </div>
        </div>
    </div>
</main>

<footer class="container text-center text-muted mt-5 pb-4">
    <p>&copy; 2008-2025 The Aspectran Project.<br>APON.js is licensed under the Apache License, Version 2.0.</p>
</footer>

<script>
    const aponInput = document.getElementById('apon-input');
    const jsonOutput = document.getElementById('json-output');
    const parseError = document.getElementById('parse-error');
    const stringifyError = document.getElementById('stringify-error');

    function runParse() {
        parseError.style.display = 'none';
        try {
            const parsed = APON.parse(aponInput.value);
            // Use 2 spaces for JSON indentation for readability
            jsonOutput.value = JSON.stringify(parsed, null, 2);
        } catch (e) {
            parseError.textContent = e.message;
            parseError.style.display = 'block';
        }
    }

    function runStringify() {
        stringifyError.style.display = 'none';
        try {
            const obj = JSON.parse(jsonOutput.value);
            aponInput.value = APON.stringify(obj, { indent: '  ' });
        } catch (e) {
            stringifyError.textContent = e.message;
            stringifyError.style.display = 'block';
        }
    }

    // Initial parse on load
    runParse();
</script>

</body>
</html>